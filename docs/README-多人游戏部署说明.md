# LIFE 多人竞速游戏 - 部署说明

## 🎮 重要说明

**只需要一个人部署WebSocket服务器，其他人只需要打开HTML文件即可！**

---

## 📋 部署方案

### 方案1：本地局域网（推荐用于测试）

#### 服务器端（只需要一个人运行）：

1. **安装Node.js**（如果还没有）
   - 下载：https://nodejs.org/
   - 安装完成后，打开终端/命令行

2. **进入后端目录并安装依赖**
   ```bash
   cd backend
   npm install
   ```

3. **运行服务器**
   ```bash
   npm start
   # 或
   node websocket-server.js
   ```
   
   服务器会显示：`WebSocket服务器运行在 ws://localhost:8080`

4. **获取你的IP地址**
   - **Mac/Linux**: 在终端运行 `ifconfig`，找到 `inet` 后面的IP（通常是 192.168.x.x）
   - **Windows**: 在命令行运行 `ipconfig`，找到 `IPv4 地址`（通常是 192.168.x.x）
   - 例如：`192.168.1.100`

#### 客户端（所有玩家）：

1. **打开前端 `frontend/index.html` 文件**

2. **在游戏大厅中配置服务器地址**：
   - 在"服务器配置"区域输入服务器地址（例如：`ws://192.168.1.100:8080`）
   - 点击"保存"按钮

3. **选择角色，创建或加入房间，开始游戏！**

---

### 方案2：云端部署（推荐用于正式使用）

#### 部署到云服务器：

1. **购买/使用云服务器**（如阿里云、腾讯云、AWS等）

2. **上传后端文件到服务器**
   - 上传整个 `backend/` 目录到服务器

3. **在服务器上安装和运行**
   ```bash
   cd backend
   npm install
   npm start
   # 或使用进程管理器
   pm2 start websocket-server.js
   ```

4. **配置防火墙**
   - 开放 8080 端口（TCP）

5. **获取服务器公网IP或域名**

#### 所有玩家：

1. **打开前端 `frontend/index.html`**

2. **在游戏大厅中配置服务器地址**：
   - 在"服务器配置"区域输入服务器地址（例如：`ws://your-server-ip:8080`）
   - 或使用域名：`wss://your-domain.com:8080`
   - 点击"保存"按钮

3. **开始游戏！**

---

### 方案3：使用免费WebSocket服务（临时测试）

可以使用一些免费的WebSocket服务，但需要修改服务器代码以适配。

**注意**：免费服务通常有连接数限制，不适合正式使用。

---

## 🚀 快速开始（最简单的方式）

### 如果你是服务器管理员：

1. 进入 `backend/` 目录，运行 `npm start` 或 `node websocket-server.js`
2. 告诉其他人你的IP地址（局域网）或域名（云端）

### 如果你是普通玩家：

1. 打开 `frontend/index.html`
2. 在游戏大厅的"服务器配置"区域输入服务器地址
3. 选择角色，创建或加入房间，开始游戏！

---

## 📝 使用流程

1. **服务器端**：进入 `backend/` 目录，运行 `npm start` 或 `node websocket-server.js`
2. **所有玩家**：
   - 打开 `frontend/index.html`
   - 配置服务器地址（在游戏大厅的"服务器配置"区域）
   - 选择角色（5种可选）
   - 创建新房间或加入已有房间
   - 等待至少2人加入后，点击"准备"按钮
   - 所有人准备后，游戏自动开始，所有人同时从Level 1开始竞速！

---

## ⚠️ 常见问题

### Q: 其他人连接不上？
A: 检查：
- 服务器是否正在运行
- IP地址是否正确
- 防火墙是否阻止了8080端口
- 所有人是否在同一个局域网（本地部署时）

### Q: 可以超过5个人吗？
A: 目前限制为最多5人，可以在 `websocket-server.js` 中修改 `rooms[roomId].players.length >= 5` 这个数字。

### Q: 服务器关闭了怎么办？
A: 游戏会自动切换到离线模式，可以单人游戏。

### Q: 如何让服务器一直运行？
A: 使用 `pm2` 或 `forever` 等工具：
```bash
npm install -g pm2
pm2 start websocket-server.js
pm2 save
```

---

## 🎯 推荐配置

- **本地测试**：方案1（局域网）
- **正式使用**：方案2（云端部署）
- **单人游戏**：直接点击"离线模式"
